<div class='container-fluid'>
    <div class='row'>
        <div class="xpositionFixed">
            <div style="padding: 0 0 18px 0;">
                <div class='col-sm-2' style="float: right;">
                    <div class="" style="width:100%;">
                        <div class="pull-right headerLogo"><a routerlink="/Home" href="/TeleUI/Home"><img
                                    style="width: 260px;" id="logo" title="לוגו משרד השיכון" src="assets/logo.png"></a>
                        </div>
                    </div>
                </div>
                <div class='col-sm-8' style="float: right;">
                    <span style="text-align: center;">
                        <h1 style="font-size: 40px;color: #0d488e;">
                            פרמטרים
                            לחישוב מחיר דירת <br>"מחיר מטרה"
                        </h1>
                        <h4 style="color: red;">הפרמטרים מפורסמים בחוברת המכרז ליזמים</h4>
                        <p-button label="נקה נתונים שמורים" (click)="clearLoca()"></p-button>
                    </span>
                </div>

            </div>
        </div>
    </div>
    <div class='row'>
        <div class='col-sm-12 body-content'>
            <div class='row'>
                <div class='col-4'>
                    <div class="">
                        <!-- <small class="col-12" style="color: red;">* שדה חובה</small> -->
                        <div class="col-12 card flex flex-column gap-2">
                            <h2 for="typeA"> בחר סוג שיטה לחישוב ההנחה<span style="color: red;">*</span></h2>
                            <div class="flex flex-column gap-3 ">
                                <div *ngFor="let TypeCalc of TypesCalc" class="field-checkbox">
                                    <p-radioButton (onClick)="onChange($event)" [inputId]="TypeCalc.code"
                                        name="TypeCalc" [value]="TypeCalc"
                                        [(ngModel)]="selectedTypeCalc"></p-radioButton>
                                    <label [for]="TypeCalc.code" class="ml-2">{{ TypeCalc.name }}</label>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 card">
                            <h2> מחיר למטר כולל מע"מ<span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="mehirLemeter"
                                inputId="minmaxfraction" mode="decimal" [min]="3000" [max]="35000"
                                [minFractionDigits]="2"> </p-inputNumber>
                            <small>ערכים מותרים בין 3,000 ל- 35,000 <br>
                                <span *ngIf="selectedTypeCalc.code!=3"> מחושב לפי שומה נכונה לדצמבר 2020 ומתעדכנת כול
                                    שנה</span>
                                <span *ngIf="selectedTypeCalc.code==3"><b>מחושב לפי שומה עדכנית</b></span>
                                <br>
                                להזין 2 מקומות לאחר הנקודה ללא עיגול</small>
                        </div>
                        <div class="col-12 card">
                            <h2> האם בניין רב קומות<span style="color: red;">*</span></h2>
                            <p-toggleButton (ngModelChange)="onChange($event); RavKomot=9;" [(ngModel)]="isRavKomot"
                                onLabel="כן" offLabel="לא"></p-toggleButton>
                            <span *ngIf="RavKomot<9" style="color: red;">אינו רב קומות</span>
                            <small> נחשב רב קומות מקומה 9 שהיא מעל 29 מטרים מהכניסה</small>
                        </div>
                        <div class="col-12 card" *ngIf="isRavKomot">
                            <h2>מספר קומות בבניין<span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="RavKomot" inputId="minmaxfraction"
                                mode="decimal" [min]="9" [max]="50" [minFractionDigits]="0">
                            </p-inputNumber>
                            <small>ערכים מותרים מעל 8, מקסימום 50 , מספרים שלמים בלבד <br> </small>
                        </div>
                        <div class="col-12 card" *ngIf="isRavKomot">
                            <h2>מספר קומה של הדירה<span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="numberKoma" inputId="minmaxfraction"
                                mode="decimal" [min]="0" [max]="50" [minFractionDigits]="0">
                            </p-inputNumber>
                            <small>ערכים מותרים בין 0 ל- 50 , מספרים שלמים בלבד </small>
                        </div>
                        <div class="col-12 card" *ngIf="MekademKoma!=0">
                            <h2>אחוז מקדמי קומה: {{MekademKoma}}</h2>
                        </div>

                        מחיר למטר כולל מע"מ - לאחר תוספת או הפחתה של מקדם הקומה
                        שטח במטרים מעל גודל דירה מירבי
                        <div class="col-12 card" *ngIf="isRavKomot">
                            <h2>שטח דירה כולל מממ"ד במטרים - מוכפל ב- 100% מחיר למטר<span style="color: red;">*</span>
                            </h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="numberHadarim"
                                inputId="minmaxfraction" mode="decimal" [min]="2.5" [max]="6" [minFractionDigits]="1">
                            </p-inputNumber>
                            <small>ערכים מותרים בין 2.5 ל- 6 </small>
                        </div>
                        <div class="col-12 card" *ngIf="numberHadarim>=4.5">
                            <h2>האם זו דירת דופלקס<span style="color: red;">*</span></h2>
                            <p-toggleButton (ngModelChange)="onChange($event)" [(ngModel)]="isDuplex" onLabel="כן"
                                offLabel="לא"></p-toggleButton>
                        </div>
                        <div class="col-12 card">
                            <h2>שטח דירה כולל מממ"ד במטרים <span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="shetachDira" inputId="minmaxfraction"
                                mode="decimal" [min]="50" [max]="199" [minFractionDigits]="0">
                            </p-inputNumber>
                            <small>מוכפל ב- 100% מחיר למטר<br>
                                ערכים מותרים בין 50 ל- 199 , לאפשר חלק ממטר ???
                            </small>
                        </div>
                        <div class="col-12 card">
                            <h2>שטח מרפסת ו/או גינה במטרים <span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="shetachMirpesetOrGina"
                                inputId="minmaxfraction" mode="decimal" [min]="0"></p-inputNumber>
                            <small>מוכפל ב- 30%* ממחיר למטר<br>
                                *כאשר שטח המרפסת ו/או הגינה גדולים מ- 30 מטר, החישוב בהתאם לסעיף 3.4.13.2 בחוברת במכרז
                                ליזמים<br><br>
                                הנחת עבודה - בכול המכרזים של מחיר מטרה, עלות מטר מרפסת 30% ממחיר למטר.<br>
                                מעל 30 מטר עד 60 מטר מוכפל ב- 20% <br>
                                מעל 60 מטר עד 120 מטר מוכפל ב- 10% <br>
                                מעל 120 מטר לא תחול גבייה
                            </small>
                        </div>
                        <div class="col-12 card">
                            <h2>שטח מחסן במטרים <span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="shetachMachsan"
                                inputId="minmaxfraction" mode="decimal" [min]="2" [max]="14"></p-inputNumber>
                            <small>מוכפל ב- 40% ממחיר למטר<br><br>
                                הנחת עבודה - בכול המכרזים של מחיר מטרה, עלות מטר מחסן 40% ממחיר למטר.<br>
                                ערכים מותרים בין 2 ל- 14
                            </small>
                        </div>
                        <div class="col-12 card">
                            <h2>מספר חניות<span style="color: red;">*</span></h2>
                            <p-inputNumber (keyup)="onChange($event)" [(ngModel)]="shetachHanayot"
                                inputId="minmaxfraction" mode="decimal" [min]="1" [max]="2"></p-inputNumber>
                            <small> מוכפל ב- 200% ממחיר למטר<br><br>
                                הנחת עבודה - בכול המכרזים של מחיר מטרה, עלות מטר חניה 200% ממחיר למטר.<br>
                                ערכים מותרים 1 או 2
                            </small>
                        </div>

                        <div class="col-12 card" *ngIf="selectedTypeCalc.code==2">
                            <h2> מקדם הצמדה קבוע מהטבלה המפורטת בסעיף 1 במכרז<span style="color: red;">*</span></h2>
                            <div class="flex align-items-center">
                                <p-radioButton [inputId]="mekademHatzmada" name="mekademHatzmada103" [value]="10.3"
                                    (ngModelChange)="onChange($event)" [(ngModel)]="mekademHatzmada"></p-radioButton>
                                <label [for]="mekademHatzmada103" class="ml-2">10.3%</label>
                            </div>
                            <div class="flex align-items-center">
                                <p-radioButton [inputId]="mekademHatzmada" name="mekademHatzmada34" [value]="3.4"
                                    (ngModelChange)="onChange($event)" [(ngModel)]="mekademHatzmada"></p-radioButton>
                                <label [for]="mekademHatzmada34" class="ml-2">3.4%</label>
                            </div>
                        </div>
                        <div class="col-12 card">
                            <h2>גובה ההנחה לצורך בדיקת הגבלת מחיר יח"ד בהשוואה למחיר יח"ד מעודכן<span
                                    style="color: red;">*</span></h2>
                            <div class="flex align-items-center" *ngIf="selectedTypeCalc.code==1">
                                <p-radioButton [inputId]="govaHanacha" name="govaHanacha300000" [value]="300000"
                                    (ngModelChange)="onChange($event)" [(ngModel)]="govaHanacha"></p-radioButton>
                                <label [for]="govaHanacha300000" class="ml-2">300,000</label>
                            </div>
                            <!-- <div class="flex align-items-center">
                                <p-radioButton [inputId]="govaHanacha" name="govaHanacha" [value]="310270"
                                    (onClick)="onChange($event)" [(ngModel)]="govaHanacha"></p-radioButton>
                                <label [for]="govaHanacha" class="ml-2">310,270</label>
                            </div> -->
                            <div class="flex align-items-center" *ngIf="selectedTypeCalc.code>=2">
                                <p-radioButton [inputId]="govaHanacha" name="govaHanacha500000" [value]="500000"
                                    (ngModelChange)="onChange($event)" [(ngModel)]="govaHanacha"></p-radioButton>
                                <label [for]="govaHanacha500000" class="ml-2">500,000</label>
                            </div>
                            <div class="flex align-items-center" *ngIf="selectedTypeCalc.code>2">
                                <p-radioButton [inputId]="govaHanacha600000" name="govaHanacha" [value]="600000"
                                    (ngModelChange)="onChange($event)" [(ngModel)]="govaHanacha"></p-radioButton>
                                <label [for]="govaHanacha600000" class="ml-2">600,000</label>
                            </div>
                            <small> ערכים בהתאם לערך שהוזן בסוג החישוב </small>
                        </div>
                    </div>
                </div>
                <div class='col-4' *ngIf="selectedTypeCalc.code>0">
                    <div>


                        <div class="col-12 card " style="background-color: aquamarine;">
                            <h5>הנחה בשיעור <span>{{hanachaBeshiur}}%</span> של כלל מרכיבי הדירה: {{sumAllMarkivim *
                                hanachaBeshiur/100 | number:'1.2-2'}}</h5>
                            <h5>סה"כ עלות מרכיבי הדירה - <b> לאחר הנחה <span>{{hanachaBeshiur}}%</span></b>:
                                {{sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100) | number:'1.2-2'}}</h5>
                        </div>

                        <div class="col-12 card " *ngIf="selectedTypeCalc.code==2"
                            style="background-color: aquamarine;">
                            <h5> מקדם הצמדה {{mekademHatzmada}}% מעלות מרכיבי הדירה: {{ sumAllMarkivim *
                                (mekademHatzmada/100) | number:'1.2-2'}}</h5>
                            <h5>סה"כ עלות מרכיבי הדירה - <b>כפול מקדם הצמדה {{mekademHatzmada}}%</b>: {{ sumAllMarkivim
                                * (1+mekademHatzmada/100) | number:'1.2-2'}}</h5>
                        </div>
                        <div class="col-12 card " *ngIf="selectedTypeCalc.code>=2" style="background-color:aquamarine;">
                            <h5>גובה ההנחה לצורך בדיקת הגבלת מחיר {{+govaHanacha | number}}</h5>
                            <h5>סה"כ עלות מרכיבי הדירה פחות סכום הגבלת גובה ההנחה: <span>{{ sumAllMarkivim - govaHanacha
                                    | number:'1.2-2'}}</span></h5>
                            <small>גובה הנחה מרבית מפורסמת בחוברת המכרז ובאתר ההרשמה להגרלות. הנחה מרבית נקבעת ע"י
                                מועצת מקרקעי ישראל</small>
                        </div>
                        <div class="col-12 card clacSum" *ngIf="selectedTypeCalc.code==2"
                            style="background-color:  aquamarine;">
                            <h5>ההפרש בין מחיר דירה עם {{hanachaBeshiur}}% למחיר דירה עם מגבלה {{+govaHanacha |
                                number}}: <b>{{ (sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)) -
                                    (sumAllMarkivim -
                                    govaHanacha) | number:'1.2-2'}}</b></h5>
                            <p-divider></p-divider>
                            <h5>ההפרש בין מחיר דירה לאחר חישוב מקדם הצמדה {{mekademHatzmada}} למחיר דירה לאחר הנחה
                                מרבית {{hanachaBeshiur}}%: <b>{{ (sumAllMarkivim *
                                    (1+mekademHatzmada/100))-(sumAllMarkivim - (sumAllMarkivim *
                                    hanachaBeshiur/100)) | number:'1.2-2'}}</b></h5>
                            <small>על מנת שההפרש יהיה גדול מ- 500,000 לדירה ממוצעת,<br>
                                המחיר למטר כולל מע"מ צריך להיות גבוהה מ- 50,535₪</small>
                            <small>ומחיר הדירה צריך להיות בגובה של 5,882,354 כולל מע"מ לפני הנחה או לפני הכפלה
                                במקדם</small>
                        </div>
                    </div>
                </div>
                <div class='col-4'>
                    <div style="position: fixed; overflow-y:hidden; overflow-x:hidden; min-width: 583px;">
                        <div *ngIf="selectedTypeCalc.code>0">
                            <div class="col-12 card">
                                <h5>סה"כ עלות מרכיבי הדירה - <b>לפני הנחה</b></h5>
                                <h4>{{sumAllMarkivim | number:'1.2-2'}} כולל מע"מ</h4>
                            </div>
                            <div class="col-11 card clacSum">
                                <h5> מחיר דירה סופי</h5>
                                מקדם או הנחה
                                <h4
                                    *ngIf="((sumAllMarkivim * (1+mekademHatzmada/100))-(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)))> +govaHanacha">
                                    {{sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)+((sumAllMarkivim *
                                    (1+mekademHatzmada/100))-(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100))) |
                                    number:'1.2-2'}}</h4>
                                <h4
                                    *ngIf="((sumAllMarkivim * (1+mekademHatzmada/100))-(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)))<= +govaHanacha">
                                    {{sumAllMarkivim -(sumAllMarkivim * hanachaBeshiur/100) | number:'1.2-2'}}</h4>
                                הנחה או מגבלה
                                <h4
                                    *ngIf="(sumAllMarkivim -govaHanacha)>(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)) ">
                                    {{(sumAllMarkivim -govaHanacha) | number:'1.2-2'}}</h4>
                                <h4
                                    *ngIf="(sumAllMarkivim -govaHanacha)<(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)) ">
                                    {{(sumAllMarkivim - (sumAllMarkivim * hanachaBeshiur/100)) | number:'1.2-2'}}</h4>
                            </div>
                        </div>
                    </div>
                    <div style="display: none;">
                        <div style="text-align: left; ">ערכי חישוב</div>
                        <div style="direction: ltr;">
                            selectedTypeCalc:{{selectedTypeCalc | json}}<br>
                            mehirLemeter:{{ mehirLemeter}}<br>
                            isRavKomot:{{ isRavKomot}}<br>
                            RavKomot:{{ RavKomot}}<br>
                            numberKoma:{{ numberKoma}}<br>
                            numberHadarim:{{ numberHadarim}}<br>
                            isDuplex:{{ isDuplex}}<br>
                            shetachDira:{{ shetachDira}}<br>
                            shetachMirpesetOrGina:{{ shetachMirpesetOrGina}}<br>
                            shetachMachsan:{{ shetachMachsan}}<br>
                            shetachHanayot:{{ shetachHanayot}}<br>
                            mekademHatzmada:{{ mekademHatzmada}}<br>
                            govaHanacha:{{ govaHanacha}}<br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>